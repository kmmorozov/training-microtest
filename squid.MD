# Основной конфигурационный файл Squid

# ==============================================================================
# ОБЩИЕ НАСТРОЙКИ
# ==============================================================================

# Порт, на котором Squid будет слушать входящие HTTP-запросы
http_port 3128

    http_port 3128: Эта директива указывает порт, на котором прокси-сервер Squid будет ожидать входящих HTTP-запросов от клиентов. Стандартным портом для HTTP-прокси является 3128.

# Указывает, что Squid должен работать в качестве прозрачного прокси (если настроено)
# transparent_proxy on

    # transparent_proxy on: Эта строка закомментирована. Если бы она была раскомментирована, это указывало бы Squid работать в режиме прозрачного прокси. В прозрачном режиме клиенты не должны явно настраивать прокси в своих браузерах, трафик перенаправляется на Squid сетевым уровнем (например, с помощью NAT или маршрутизации). В данном случае прозрачный режим не включен.

# ==============================================================================
# НАСТРОЙКИ КЭШИРОВАНИЯ
# ==============================================================================

# Директория для хранения кэша.
# cache_dir ufs /var/spool/squid 100 16 256
# ufs - тип кэша, /var/spool/squid - путь, 100 - размер в мегабайтах, 16 - количество первых директорий, 256 - количество поддиректорий

# Максимальный размер объекта, который будет кэшироваться (в килобайтах)
maximum_object_size 10240 KB

    maximum_object_size 10240 KB: Эта директива устанавливает максимальный размер объекта, который Squid будет пытаться кэшировать. В данном случае установлено значение 10240 килобайт (10 мегабайт). Объекты больше этого размера не будут кэшироваться.

# Минимальный размер объекта, который будет кэшироваться (в килобайтах)
minimum_object_size 0 KB

    minimum_object_size 0 KB: Эта директива устанавливает минимальный размер объекта, который Squid будет пытаться кэшировать. Значение 0 означает, что будут кэшироваться объекты любого размера (кроме тех, что превышают maximum_object_size).

# ==============================================================================
# НАСТРОЙКИ ДОСТУПА (ACL - Access Control List)
# ==============================================================================

# Определяем список разрешенных локальных сетей.
# Замените 192.168.1.0/24 на вашу локальную сеть.
acl localnet src 192.168.1.0/24

    acl localnet src 192.168.1.0/24: Эта директива определяет список контроля доступа (ACL) с именем localnet. acl используется для определения списков, которые затем могут использоваться в правилах http_access. src указывает, что правило применяется к исходным IP-адресам запросов. 192.168.1.0/24 представляет собой диапазон IP-адресов локальной сети (в формате CIDR). Вам необходимо заменить этот диапазон на диапазон IP-адресов вашей реальной локальной сети.

# Определяем ACL для блокировки определенного домена.
# Домен, который мы хотим заблокировать.
acl blocked_sites dstdomain rogikopyta.ru

    acl blocked_sites dstdomain rogikopyta.ru: Эта директива определяет еще один ACL с именем blocked_sites. dstdomain указывает, что правило применяется к доменным именам назначения (сайтам, к которым пытается обратиться клиент). В данном случае, в этот ACL включен домен rogikopyta.ru.

# ==============================================================================
# ПРАВИЛА ДОСТУПА (http_access)
# ==============================================================================

# Разрешаем доступ для локальной сети.
http_access allow localnet

    http_access allow localnet: Эта директива определяет правило доступа. http_access используется для определения того, какие запросы разрешены или запрещены. allow указывает, что доступ разрешен, а localnet ссылается на ранее определенный ACL, разрешающий доступ для IP-адресов из вашей локальной сети.

# Запрещаем доступ к сайтам из списка blocked_sites.
http_access deny blocked_sites

    http_access deny blocked_sites: Это правило запрещает доступ к веб-сайтам, которые включены в ACL blocked_sites (в данном случае, rogikopyta.ru).

# Запрещаем доступ ко всем остальным (по умолчанию).
http_access deny all

    http_access deny all: Это правило является правилом по умолчанию. Оно запрещает доступ ко всем запросам, которые не были явно разрешены предыдущими правилами. Это обеспечивает политику "запрещено все, что не разрешено явно" (deny all unless explicitly allowed).

# ==============================================================================
# НАСТРОЙКИ ДЛЯ МЕНЕДЖЕРА SQUID (опционально)
# ==============================================================================

# Разрешаем доступ к интерфейсу менеджера Squid только из локальной сети.
http_access allow manager localhost
http_access allow manager localnet
http_access deny manager

    Эти строки управляют доступом к интерфейсу менеджера Squid, который используется для мониторинга и управления прокси-сервером.
        http_access allow manager localhost: Разрешает доступ к менеджеру с самого сервера Squid (localhost).
        http_access allow manager localnet: Разрешает доступ к менеджеру из локальной сети.
        http_access deny manager: Запрещает доступ к менеджеру для всех остальных.

# ==============================================================================
# НАСТРОЙКИ ДЛЯ АУТЕНТИФИКАЦИИ (опционально)
# ==============================================================================

# Если вы хотите использовать аутентификацию, раскомментируйте и настройте соответствующую строку.
# auth_param basic program /usr/lib64/squid/basic_ncsa_auth /etc/squid/passwd
# auth_param basic realm Squid proxy-cache
# acl authenticated proxy_auth REQUIRED
# http_access allow authenticated
# http_access deny !authenticated

    Эти строки представляют собой пример настроек для базовой аутентификации пользователей. Они закомментированы, так как аутентификация не является обязательной для базовой работы прокси-сервера. Если вам требуется аутентификация, вам нужно будет раскомментировать и настроить эти параметры, указав путь к файлу с паролями и настроив realm (область аутентификации).

# ==============================================================================
# ДРУГИЕ НАСТРОЙКИ (некоторые примеры)
# ==============================================================================

# Указывает DNS-серверы, которые будет использовать Squid (если не настроены в системе).
# dns_nameserver 8.8.8.8
# dns_nameserver 8.8.4.4

    Эти строки показывают пример настройки DNS-серверов, которые будет использовать Squid для разрешения доменных имен. Если DNS-серверы уже настроены в вашей операционной системе, эти строки могут быть не нужны.

# ==============================================================================
# КОНЕЦ КОНФИГУРАЦИИ
# ==============================================================================

Основные принципы работы этой конфигурации:

    Разрешен доступ из локальной сети: Пользователи, чьи IP-адреса находятся в диапазоне 192.168.1.0/24 (или вашем настроенном диапазоне), могут использовать прокси для доступа к интернету.
    Запрещен доступ к определенному сайту: Попытки доступа к сайту rogikopyta.ru будут заблокированы для всех пользователей.
    По умолчанию доступ запрещен: Все остальные запросы, не соответствующие правилам allow, будут отклонены.
    Доступ к менеджеру ограничен: Доступ к административному интерфейсу Squid ограничен локальным хостом и устройствами из локальной сети.

Важно помнить:

    Замените 192.168.1.0/24 на IP-диапазон вашей локальной сети.
    После внесения изменений в файл конфигурации необходимо сохранить файл и перезапустить службу Squid для применения изменений.
    Эта конфигурация является базовой. Для более сложных сценариев (например, более детального контроля доступа, аутентификации, кеширования) потребуется более глубокая настройка Squid.
